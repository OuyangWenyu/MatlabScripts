function x = datenum2(dd)
% datenum2([y m d]) or datenum2([y jd]) or datenum2(yyyymmdd)
% a faster version of datenum by Chaopeng
    
    if length(dd)==1
        [d,y]=ymd2jd(dd,3);
    elseif length(dd)==3
        y = dd(1); %m =  dd(2); d = dd(3);
        d=ymd2jd(dd,3);
    elseif length(dd)==2
        y = dd(1); %m =  dd(2); d = dd(3);
        d = dd(2);
    end
    try
        if y>=1950 && y<=2050
            ii = y - 1949;
            % datenums of first day of every year from 1950 to 2050:
            datenums = [712224,712589,712954,713320,713685,714050,714415,714781,715146,715511,...
                715876,716242,716607,716972,717337,717703,718068,718433,718798,719164,...
                719529,719894,720259,720625,720990,721355,721720,722086,722451,722816,...
                723181,723547,723912,724277,724642,725008,725373,725738,726103,726469,...
                726834,727199,727564,727930,728295,728660,729025,729391,729756,730121,...
                730486,730852,731217,731582,731947,732313,732678,733043,733408,733774,...
                734139,734504,734869,735235,735600,735965,736330,736696,737061,737426,...
                737791,738157,738522,738887,739252,739618,739983,740348,740713,741079,...
                741444,741809,742174,742540,742905,743270,743635,744001,744366,744731,...
                745096,745462,745827,746192,746557,746923,747288,747653,748018,748384,748749;];
        elseif y>=1850 && y<1950
            ii = y - 1849;
            datenums = [675700,676065,676430,676796,677161,677526,677891,678257,678622,...
                678987,679352,679718,680083,680448,680813,681179,681544,681909,682274,...
                682640,683005,683370,683735,684101,684466,684831,685196,685562,685927,...
                686292,686657,687023,687388,687753,688118,688484,688849,689214,689579,...
                689945,690310,690675,691040,691406,691771,692136,692501,692867,693232,...
                693597,693962,694327,694692,695057,695422,695788,696153,696518,696883,...
                697249,697614,697979,698344,698710,699075,699440,699805,700171,700536,...
                700901,701266,701632,701997,702362,702727,703093,703458,703823,704188,...
                704554,704919,705284,705649,706015,706380,706745,707110,707476,707841,...
                708206,708571,708937,709302,709667,710032,710398,710763,711128,711493,711859];
        else
            ii= 1;
            datenums = datenum(num2str(dd),'yyyymmdd'); d = 1; % revert back to datenum
        end
        x = datenums(ii) + d - 1;
    catch
        error('time exceeded 1950~2050 which is the range of datenum2')
    end
end